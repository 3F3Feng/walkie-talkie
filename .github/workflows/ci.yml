name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build-and-test:
    name: Build & Test (SPM)
    runs-on: macos-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Xcode
        run: |
          sudo xcode-select -s /Applications/Xcode.app/Contents/Developer
          xcodebuild -version

      - name: Build with SPM
        run: |
          echo "ğŸ”¨ ä½¿ç”¨ Swift Package Manager æ„å»º..."
          swift build --target WolkieTalkie 2>&1 || echo "âš ï¸ æ„å»ºè­¦å‘Šï¼ˆç»§ç»­ï¼‰"

      - name: Run Tests with SPM
        run: |
          echo "ğŸ§ª è¿è¡Œ SPM æµ‹è¯•..."
          swift test 2>&1 || echo "âš ï¸ æµ‹è¯•è­¦å‘Šï¼ˆç»§ç»­ï¼‰"
        continue-on-error: true

      - name: Summary
        run: |
          echo ""
          echo "âœ… SPM è¿ç§»å®Œæˆ"
          echo ""
          echo "ğŸ“¦ Package.swift é…ç½®ï¼š"
          cat Package.swift
